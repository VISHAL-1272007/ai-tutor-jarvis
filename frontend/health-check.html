<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>JARVIS AI - Professional AI Assistant</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ¤–</text></svg>">
    <!-- Professional Styles -->
    <link rel="stylesheet" href="style-pro.css?v=2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <!-- Tracer Disabled -->
    <!-- <script src="tracer.js"></script> -->
</head>

<body>
    <div class="container">
        <h1>ğŸ¥ System Health Check</h1>

        <div id="backend-status" class="status-card loading">
            <div class="status-title">
                <span class="emoji">ğŸ”Œ</span>
                Backend API
            </div>
            <div class="status-message">Checking connection...</div>
        </div>

        <div id="firebase-status" class="status-card loading">
            <div class="status-title">
                <span class="emoji">ğŸ”¥</span>
                Firebase Database
            </div>
            <div class="status-message">Initializing...</div>
        </div>

        <div id="hosting-status" class="status-card loading">
            <div class="status-title">
                <span class="emoji">ğŸŒ</span>
                Frontend Hosting
            </div>
            <div class="status-message">Verifying...</div>
        </div>

        <button class="btn" id="goToApp" disabled>
            ğŸš€ Go to Main App
        </button>
    </div>

    <script type="module">
        async function checkBackend() {
            const card = document.getElementById('backend-status');
            const message = card.querySelector('.status-message');

            try {
                const response = await fetch('https://ai-tutor-jarvis.onrender.com/health');
                const data = await response.json();

                card.className = 'status-card success';
                message.textContent = `âœ… Online - ${data.status}`;
                return true;
            } catch (error) {
                card.className = 'status-card error';
                message.textContent = `âŒ Connection failed: ${error.message}`;
                return false;
            }
        }

        async function checkFirebase() {
            const card = document.getElementById('firebase-status');
            const message = card.querySelector('.status-message');

            try {
                const { initializeApp } = await import("https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js");
                const { getAuth } = await import("https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js");

                const firebaseConfig = {
                    apiKey: "AIzaSyBL-9W-Dxg-FVwKTQ9NYwwYVpBiSNXaZIg",
                    authDomain: "vishai-f6197.firebaseapp.com",
                    projectId: "vishai-f6197"
                };

                const app = initializeApp(firebaseConfig);
                const auth = getAuth(app);

                card.className = 'status-card success';
                message.textContent = 'âœ… Connected - Authentication ready';
                return true;
            } catch (error) {
                card.className = 'status-card error';
                message.textContent = `âŒ Initialization failed: ${error.message}`;
                return false;
            }
        }

        function checkHosting() {
            const card = document.getElementById('hosting-status');
            const message = card.querySelector('.status-message');

            card.className = 'status-card success';
            message.textContent = 'âœ… Active - You are viewing this page!';
            return true;
        }

        async function runHealthCheck() {
            const [backend, firebase, hosting] = await Promise.all([
                checkBackend(),
                checkFirebase(),
                checkHosting()
            ]);

            const btn = document.getElementById('goToApp');

            if (backend && firebase && hosting) {
                btn.disabled = false;
                btn.textContent = 'âœ… All Systems Operational - Go to App';
                btn.onclick = () => window.location.href = '/index.html';
            } else {
                btn.textContent = 'âš ï¸ Some Systems Down - Try Anyway';
                btn.disabled = false;
                btn.onclick = () => {
                    if (confirm('Some services are offline. Continue anyway?')) {
                        window.location.href = '/index.html';
                    }
                };
            }
        }

        // Run health check on load
        runHealthCheck();
    </script>
</body>

</html>